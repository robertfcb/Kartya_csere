<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cserek√°rtya N√©zeget≈ë</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f0f4f8; }
        .card-viewer { min-height: 400px; }
        
        /* A k√©p kit√∂lti a ter√ºletet, de nem v√°gja le a sz√©l√©t. */
        #card-image { object-fit: contain !important; }
        /* Modern bet≈±t√≠pus a log√≥hoz */
        .modern-font { font-family: 'Inter', sans-serif; letter-spacing: 0.1em; }

        /* KONFETTI/H√ìPEHELY ANIM√ÅCI√ì ST√çLUSOK (CSAK A KEZD≈êK√âPERNY≈êN L√ÅTHAT√ì) */
        .confetti-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 5;
        }
        .confetti {
            position: absolute;
            width: 8px;
            height: 8px;
            background-color: transparent;
            border-radius: 50%;
        }
        /* A pehely meg√°ll a kont√©ner alj√°n (kb. 15px t√°vols√°gra) */
        @keyframes fall {
            from { top: -10px; } 
            to { top: calc(100% - 15px); }
        }
        
        /* MOBIL N√âZET ST√çLUSOK */
        @media (max-width: 767px) {
            /* 1. Men√º elrejt√©se alap√©rtelmez√©sben */
            #mobile-menu-wrapper {
                position: fixed; /* Fix poz√≠ci√≥, hogy fel√ºl√≠rja a flex elrendez√©st */
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                z-index: 40; /* Magasan legyen */
                background-color: rgba(240, 244, 248, 0.95); /* √Åtl√°tsz√≥ h√°tt√©r */
                padding: 1rem;
                display: none; /* Rejtett alap√©rtelmez√©sben */
                overflow-y: auto;
            }

            /* Men√º, ha l√°that√≥ */
            #mobile-menu-wrapper.show {
                display: block;
            }

            /* 2. Lebeg≈ë gomb */
            #mobile-menu-toggle {
                position: fixed;
                top: 1.5rem; /* FEL FELS≈ê SAROK */
                left: 1.5rem; /* BAL FELS≈ê SAROK */
                bottom: auto; /* Elt√°vol√≠tva a bottom poz√≠ci√≥ */
                right: auto; /* Elt√°vol√≠tva a right poz√≠ci√≥ */
                z-index: 50;
                display: block;
            }
            
            /* JAV√çTVA: Balra igaz√≠tjuk a gombokat mobilon is */
            #mobile-menu-wrapper .filter-button {
                max-width: 90%; /* Kicsit sz√©lesebbre √°ll√≠tva */
                margin-left: 0; /* Balra igaz√≠tva */
                margin-right: auto;
                text-align: left !important; /* Balra igaz√≠tva */
            }
            
            /* A klub leny√≠l√≥ men√º gombjainak igaz√≠t√°sa (a beh√∫z√°s elt√°vol√≠t√°sa) */
            #mobile-menu-wrapper #club-dropdown-menu .filter-button {
                padding-left: 1rem; 
            }

            /* A klubok f≈ë gombj√°nak sz√∂veg igaz√≠t√°sa */
            #club-main-button {
                 text-align: left !important; /* Balra igaz√≠tva */
                 max-width: 90%;
                 margin-left: 0;
                 margin-right: auto;
            }
            
            /* Maga a men√º kont√©ner k√∂z√©pre van igaz√≠tva, de a gombok balra vannak igaz√≠tva a kont√©ner√ºkben */
            #mobile-menu-wrapper aside {
                max-width: 350px;
                margin-left: auto;
                margin-right: auto;
            }
        }
        
        /* ASZTALI N√âZET ST√çLUSOK (megjelenik a men√º, elt≈±nik a gomb) */
        @media (min-width: 768px) {
            #mobile-menu-toggle {
                display: none !important; 
            }
        }

        /* √öJ ST√çLUS: A leny√≠l√≥ klubmen√º a gombon bel√ºl marad, lefel√© ny√≠lik */
        #club-dropdown-menu {
            position: static; 
            width: 100%;
            margin-top: 0;
            margin-left: 0;
            background-color: #f8f8f8; 
            border: none;
            box-shadow: none;
            padding: 0.5rem 0;
            border-radius: 0 0 8px 8px;
            max-height: 250px; 
        }
        #club-dropdown-menu li {
            padding: 0;
        }
        #club-dropdown-menu .filter-button {
            padding-left: 1.5rem; 
            font-weight: 400; 
        }

    </style>
</head>
<body class="text-[#073B4C] min-h-screen">

    <!-- 3. MOBIL LEBEG≈ê MEN√ú GOMB -->
    <button id="mobile-menu-toggle" 
            class="bg-[#118AB2] text-white p-4 rounded-full shadow-2xl transition-all hover:bg-[#FF6B6B] focus:outline-none focus:ring-4 focus:ring-[#118AB2] focus:ring-opacity-50">
        <!-- Unicode Ikon a men√ºnek (Hamburger) -->
        <span id="toggle-icon" class="text-2xl">‚ò∞</span>
    </button>
    <!-- END MOBIL GOMB -->

    <div class="container mx-auto p-4 md:p-8">
        
        <!-- √öJ FLEX CONTAINER: OLDALS√ÅV + F≈ê TARTALOM -->
        <div class="flex flex-col md:flex-row gap-8">
            
            <!-- 1. BAL OLDALI MEN√úS√ÅV (ASIDE) -->
            <!-- Mobilon a men√º rejtett, csak a gomb h√≠vja el≈ë -->
            <div id="mobile-menu-wrapper" class="md:w-64 w-full">
                <aside class="md:w-64 w-full bg-white rounded-xl shadow-2xl p-4 md:p-6 md:sticky md:top-8 md:h-[calc(100vh-64px)] md:overflow-y-auto">
                    <!-- F≈ë C√≠m beillesztve az oldals√°v tetej√©re -->
                    <header class="text-center mb-6">
                        <h1 class="text-2xl font-extrabold text-[#118AB2]">CSERE K√ÅRTY√ÅK</h1>
                        <p class="mt-1 text-sm text-gray-600">Lapozhat√≥ lista</p>
                    </header>

                    <nav>
                        <h3 class="text-lg font-bold text-[#FF6B6B] mb-4 border-b pb-2 border-gray-200">Kateg√≥ri√°k</h3>
                        
                        <!-- Kateg√≥ria gombok gener√°l√°sa JS-b≈ël -->
                        <div id="category-filter" class="flex flex-col gap-2">
                            <!-- JS GENERATED BUTTONS GO HERE -->
                        </div>
                    </nav>
                </aside>
            </div>

            <!-- 2. F≈ê TARTALOM / K√ÅRTYA N√âZEGET≈ê (MAIN) -->
            <main class="md:flex-1">
                <div id="card-viewer-container" class="bg-white rounded-xl shadow-2xl p-6 card-viewer flex flex-col items-center justify-between">
                    
                    <!-- Kezd≈ëk√©perny≈ë / K√°rtya adatok -->
                    <div id="card-display-area" class="w-full max-w-xl text-center">
                        
                        <!-- Semleges kezd≈ëk√©perny≈ë tartalom (Default View) -->
                        <div id="welcome-screen" class="p-8 relative">
                            
                            <!-- KONFETTI CONTAINER -->
                            <div id="confetti-effect" class="confetti-container"></div>
                            <!-- END KONFETTI -->

                            <!-- F≈ê TARTALOM (Z-INDEX 10-ZEL) -->
                            <div class="relative z-10">
                                
                                <!-- Friss√≠tett log√≥ √©s felirat -->
                                <h2 class="text-5xl md:text-6xl font-extrabold text-[#073B4C] modern-font mb-2 tracking-tighter relative z-10">
                                    PANINI ADRENALYN
                                </h2>
                                <p class="4xl font-black text-[#FF6B6B] modern-font mb-6 tracking-widest relative z-10">
                                    XL <span class="text-[#06D6A0]">2026</span>
                                </p>
                                
                                <!-- BANNER HELY MOBILRA BEILLESZTVE -->
                                <div id="banner-container-mobile" class="mt-4 mb-4">
                                    <div class="bg-gray-100 p-2 rounded-lg shadow-sm text-center max-w-lg mx-auto">
                                        <img src="https://i.imgur.com/tNTULFh.jpeg" 
                                             alt="Banner k√©p helykit√∂lt≈ë" 
                                             class="w-full h-auto max-h-24 object-cover rounded-md mx-auto"
                                             onerror="this.onerror=null;this.src='https://placehold.co/700x120/073B4C/FFFFFF?text=K√©p+Nem+El√©rhet≈ë'">
                                    </div>
                                </div>
                                <!-- END BANNER HELY MOBILRA -->

                                <p class="mt-2 text-md text-gray-500 relative z-10">
                                    A csere k√°rty√°kat kateg√≥ri√°kra bontva tal√°lod a men√ºben. A hi√°nyz√≥ k√°rty√°imat k√ºl√∂n men√ºben tal√°lod.
                                </p>

                                <!-- Kapcsolatfelv√©teli sz√∂veg -->
                                <p class="mt-12 text-md md:text-lg font-semibold text-[#FF6B6B] modern-font relative z-10">
                                    Minden csere k√°rtya hib√°tlan √°llapotban, v√©d≈ëtasakban van.
                                    <br>
                                    
                                </p>
                                <!-- END √öJ -->
                            </div>
                        </div>
                        
                        <!-- HI√ÅNYZ√ì K√ÅRTY√ÅK N√âZET -->
                        <div id="missing-cards-view" class="hidden text-left max-w-full mx-auto p-4 md:p-8">
                            <h2 class="text-3xl font-extrabold text-[#073B4C] modern-font mb-2 tracking-tighter">
                                PANINI ADRENALYN
                            </h2>
                            <p class="text-2xl font-black text-[#FF6B6B] modern-font mb-6 tracking-widest">
                                XL <span class="text-[#06D6A0]">2026</span>
                            </p>
                            <h3 class="text-xl font-bold text-[#118AB2] mb-4">Hi√°nyz√≥ Lapok R√©szletes List√°ja</h3>
                            <div id="missing-cards-list" class="space-y-4">
                                <!-- JS gener√°lja ide a hi√°nyz√≥ lapokat -->
                            </div>
                        </div>
                        <!-- END HI√ÅNYZ√ì K√ÅRTY√ÅK N√âZET -->


                        <!-- K√°rtya megjelen√≠t√©s (Filtered View - Rejtve ind√≠t√°skor) -->
                        <div id="filtered-card-view" class="hidden">
                            <p id="current-category" class="text-xl font-bold text-[#FF6B6B] mb-4 uppercase"></p>
                            <div class="relative w-full h-80 bg-gray-200 rounded-lg overflow-hidden shadow-xl mb-4 mx-auto max-w-[300px]">
                                <img id="card-image" class="w-full h-full transition-opacity duration-300" 
                                    src="https://placehold.co/300x400/06D6A0/073B4C?text=Cserek%C3%A1rtya+Fot%C3%B3" 
                                    onerror="this.onerror=null;this.src='https://placehold.co/300x400/06D6A0/073B4C?text=K%C3%A9p+Nem+El%C9%A5rhet%C5%90'">
                            </div>
                            
                            <h2 id="card-name" class="3xl font-extrabold text-[#073B4C] my-2">K√°rtya Neve</h2>
                            <p class="text-lg font-semibold text-[#118AB2]">Sorsz√°m: <span id="card-number" class="text-[#073B4C]">00</span></p>
                            <p class="text-md text-gray-500">Csapat: <span id="card-team">Nincs Adat</span></p>
                        </div>
                    </div>

                    <!-- Lapoz√≥ gombok (Rejtve ind√≠t√°skor) -->
                    <div id="pagination-controls" class="hidden flex justify-between w-full max-w-xl mt-6">
                        <button id="prev-button" 
                                class="bg-[#FFD166] text-[#073B4C] font-bold py-3 px-6 rounded-full shadow-lg transition-all hover:bg-[#FF6B6B] hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed">
                            &larr; El≈ëz≈ë
                        </button>
                        
                        <p id="card-counter" class="text-xl font-bold self-center text-[#118AB2]"></p>

                        <button id="next-button" 
                                class="bg-[#FFD166] text-[#073B4C] font-bold py-3 px-6 rounded-full shadow-lg transition-all hover:bg-[#06D6A0] hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed">
                            K√∂vetkez≈ë &rarr;
                        </button>
                    </div>
                </div>
                
                <!-- A kor√°bban itt l√©v≈ë banner kont√©ner is elt√°vol√≠tva -->

            </main>
        </div>
    </div>

<script>
    
    // A K√ÅRTY√ÅK KATEG√ìRI√ÅI √âS A KLUBNEVEK MOST M√ÅR K√úL√ñN SZ≈∞R≈êDNEK!

    const MISSING_CARDS_DATA = {
        "World Cup": "5, 6, 8, 12, 17, 18, 21, 23, 25, 31, 32, 34, 35",
        "Elite k√°rty√°k": "1, 2, 4, 7, 10, 18",
        "Fans' favourite k√°rty√°k": "3, 5, 6, 13, 16, 19, 20, 21, 24, 25, 27, 28, 29, 38, 40, 43, 44, 45, 51, 55, 56, 58, 60, 61, 64, 66, 67, 71, 73, 74, 79, 80, 92, 97",
        "Botafogo": "3, 10, 13",
        "Frankfurt": "1, 5, 11, 13, 16, 17",
        "Liverpool": "6, 9, 10, 11, 12, 13, 14",
        "Olympiacos": "13, 18",
        "Marseille": "5, 18",
        "Inter": "1, 2, 3, 7, 14",
        "Paris": "1, 3, 7, 13, 14, 16",
        "Milan": "3, 4, 5, 6, 12",
        "Leverkusen": "2, 5, 7, 10, 11, 13, 14, 18",
        "Ajax": "10, 11",
        "PSV": "3, 4, 6, 8, 10, 16, 17, 18",
        "Sporting": "6, 9, 15",
        "Al Nassr": "1, 7, 8, 9, 11, 13",
        "Atletico Madrid": "2, 4",
        "Barcelona": "1, 12, 15, 16",
        "Real Madrid": "5, 8, 12, 13, 15"
    };

    const swapCardsData = [
        // Ide illeszd be a k√°rtya adataidat! FONTOS: vessz≈ëvel v√°laszd el az elemeket, √©s az utols√≥ ut√°n NE tegy√©l vessz≈ët!
        
        // K√úL√ñNLEGES K√ÅRTY√ÅK MINT√ÅI
        { category: "World Cup", name: "WC Lap 1 (Minta)", number: 40, team: "Brazil", img: "https://placehold.co/300x400/118AB2/ffffff?text=World+Cup+40", isClub: false },
        { category: "World Cup", name: "WC Lap - Harry Kane", number: 12, team: "England", img: "https://placehold.co/300x400/118AB2/ffffff?text=WC+England+12", isClub: false },
        { category: "Elite k√°rty√°k", name: "Cristiano Ronaldo", number: 19, team: "Al Nassr", img: "https://placehold.co/300x400/FF6B6B/ffffff?text=Elite+Ronaldo", isClub: false },
        { category: "Fans' favourite k√°rty√°k", name: "Fan Fav Lap A", number: 98, team: "Best Player A", img: "https://placehold.co/300x400/FFD166/073B4C?text=Fan+Fav+98", isClub: false },
        { category: "Golden Baller", name: "Golden Baller Lap", number: 1, team: "Messi", img: "https://placehold.co/300x400/FFD166/073B4C?text=Golden+Baller+1", isClub: false },
        
        // PARALEL K√ÅRTY√ÅK MINT√ÅI
        { category: "K√©k paralel", name: "K√©k Paralel Lap", number: 55, team: "Chelsea", img: "https://placehold.co/300x400/118AB2/ffffff?text=K%C3%A9k+Paralel+55", isClub: false },
        { category: "Piros paralel", name: "Piros Paralel Lap", number: 66, team: "Arsenal", img: "https://placehold.co/300x400/FF6B6B/ffffff?text=Piros+Paralel+66", isClub: false },
        { category: "R√≥zsasz√≠n paralel", name: "R√≥zsasz√≠n Paralel Lap", number: 77, team: "PSG", img: "https://placehold.co/300x400/FF6B6B/ffffff?text=R%C3%B3zsasz%C3%ADn+77", isClub: false },
        
        // KLUB K√ÅRTY√ÅK MINT√ÅI (isClub: true)
        { category: "Klub K√°rty√°k", name: "Leverkusen Lap 1", number: 10, team: "Leverkusen", img: "https://placehold.co/300x400/06D6A0/073B4C?text=Leverkusen+10", isClub: true },
        { category: "Klub K√°rty√°k", name: "PSV Lap 1", number: 5, team: "PSV", img: "https://placehold.co/300x400/118AB2/ffffff?text=PSV+5", isClub: true },
        { category: "Klub K√°rty√°k", name: "Liverpool Lap 1", number: 6, team: "Liverpool", img: "https://placehold.co/300x400/FF6B6B/ffffff?text=Liverpool+6", isClub: true },
        { category: "Klub K√°rty√°k", name: "Frankfurt Lap 1", number: 1, team: "Frankfurt", img: "https://placehold.co/300x400/FFD166/073B4C?text=Frankfurt+1", isClub: true },
        { category: "Klub K√°rty√°k", name: "Paris Lap 1", number: 1, team: "Paris", img: "https://placehold.co/300x400/06D6A0/073B4C?text=Paris+1", isClub: true },
        { category: "Klub K√°rty√°k", name: "Al Nassr Lap 1", number: 1, team: "Al Nassr", img: "https://placehold.co/300x400/118AB2/ffffff?text=Al+Nassr+1", isClub: true },
        { category: "Klub K√°rty√°k", name: "Inter Lap 1", number: 1, team: "Inter", img: "https://placehold.co/300x400/FF6B6B/ffffff?text=Inter+1", isClub: true },
        { category: "Klub K√°rty√°k", name: "Milan Lap 1", number: 3, team: "Milan", img: "https://placehold.co/300x400/FFD166/073B4C?text=Milan+3", isClub: true },
        { category: "Klub K√°rty√°k", name: "Real Madrid Lap 1", number: 5, team: "Real Madrid", img: "https://placehold.co/300x400/06D6A0/073B4C?text=Real+5", isClub: true },
        { category: "Klub K√°rty√°k", name: "Barcelona Lap 1", number: 1, team: "Barcelona", img: "https://placehold.co/300x400/118AB2/ffffff?text=Barcelona+1", isClub: true },
        { category: "Klub K√°rty√°k", name: "Botafogo Lap 1", number: 3, team: "Botafogo", img: "https://placehold.co/300x400/FF6B6B/ffffff?text=Botafogo+3", isClub: true },
        { category: "Klub K√°rty√°k", name: "Sporting Lap 1", number: 6, team: "Sporting", img: "https://placehold.co/300x400/FFD166/073B4C?text=Sporting+6", isClub: true },
        { category: "Klub K√°rty√°k", name: "Olympiacos Lap 1", number: 13, team: "Olympiacos", img: "https://placehold.co/300x400/06D6A0/073B4C?text=Olympiacos+13", isClub: true },
        { category: "Klub K√°rty√°k", name: "Marseille Lap 1", number: 5, team: "Marseille", img: "https://placehold.co/300x400/118AB2/ffffff?text=Marseille+5", isClub: true },
        { category: "Klub K√°rty√°k", name: "Ajax Lap 1", number: 10, team: "Ajax", img: "https://placehold.co/300x400/FF6B6B/ffffff?text=Ajax+10", isClub: true },
        { category: "Klub K√°rty√°k", name: "Atletico Madrid Lap 1", number: 2, team: "Atletico Madrid", img: "https://placehold.co/300x400/FFD166/073B4C?text=Atletico+2", isClub: true }
    ];

    let currentCategory = null; // null-ra √°ll√≠tva a kezd≈ëk√©perny≈ë miatt
    let currentCardIndex = 0;
    let filteredCards = [];

    // K√ºl√∂n defini√°ljuk a struktur√°lt kateg√≥ri√°kat, hogy a gombfriss√≠t√©sn√©l is el√©rhet≈ë legyen.
    let structuredCategories = {}; 

    const elements = {
        filterContainer: document.getElementById('category-filter'),
        cardImage: document.getElementById('card-image'),
        cardName: document.getElementById('card-name'),
        cardNumber: document.getElementById('card-number'),
        cardTeam: document.getElementById('card-team'),
        currentCategoryEl: document.getElementById('current-category'),
        cardCounter: document.getElementById('card-counter'),
        prevButton: document.getElementById('prev-button'),
        nextButton: document.getElementById('next-button'),
        welcomeScreen: document.getElementById('welcome-screen'),
        filteredCardView: document.getElementById('filtered-card-view'),
        paginationControls: document.getElementById('pagination-controls'),
        confettiEffect: document.getElementById('confetti-effect'),
        mobileMenuWrapper: document.getElementById('mobile-menu-wrapper'),
        mobileMenuToggle: document.getElementById('mobile-menu-toggle'),
        toggleIcon: document.getElementById('toggle-icon'),
        missingCardsView: document.getElementById('missing-cards-view'),
        missingCardsList: document.getElementById('missing-cards-list')
    };

    const HUNGARIAN_COLORS = ['#FF6B6B', '#FFFFFF', '#06D6A0'];

    let confettiInterval;

    function startConfetti() {
        stopConfetti(); 

        const container = elements.confettiEffect;
        
        function createConfetti() {
            const confetti = document.createElement('div');
            confetti.classList.add('confetti');

            const color = HUNGARIAN_COLORS[Math.floor(Math.random() * HUNGARIAN_COLORS.length)];
            confetti.style.backgroundColor = color === '#FFFFFF' ? 'rgba(255, 255, 255, 0.7)' : color;
            
            const startX = Math.random() * container.offsetWidth;
            const size = Math.random() * 8 + 4;
            const duration = Math.random() * 5 + 7;

            confetti.style.left = startX + 'px';
            confetti.style.width = size + 'px';
            confetti.style.height = size + 'px';
            
            confetti.style.animation = `fall ${duration}s linear forwards`; 
            
            container.appendChild(confetti);
        }

        confettiInterval = setInterval(createConfetti, 500); 
    }

    function stopConfetti() {
        if (confettiInterval) {
            clearInterval(confettiInterval);
            confettiInterval = null;
        }
    }


    // √öJ F√úGGV√âNY: Struktur√°lt kateg√≥ri√°kat ad vissza a men√º √©p√≠t√©s√©hez.
    function getStructuredCategories() {
        const clubNames = Array.from(new Set(swapCardsData
            .filter(card => card.isClub)
            .map(card => card.team)
        )).sort();

        const specialCategories = Array.from(new Set(swapCardsData
            .filter(card => !card.isClub)
            .map(card => card.category)
        )).filter(cat => cat !== 'Klub K√°rty√°k').sort();

        structuredCategories = {
            regular: ['Kezd≈ëoldal', 'Hi√°nyz√≥ K√°rty√°k', ...specialCategories], // '√ñsszes k√°rtya' elt√°vol√≠tva
            clubs: clubNames
        };
        return structuredCategories;
    }

    // √öJ F√úGGV√âNY: Kezeli a mobil men√º megjelen√≠t√©s√©t/elrejt√©s√©t.
    function toggleMobileMenu(show) {
        if (window.innerWidth >= 768) return; // Asztali g√©pen ne csin√°ljon semmit

        if (show === true || elements.mobileMenuWrapper.classList.contains('show') === false) {
            elements.mobileMenuWrapper.classList.add('show');
            elements.toggleIcon.textContent = '‚úï'; // Ikon v√°lt√°s Bez√°r√°sra
        } else {
            elements.mobileMenuWrapper.classList.remove('show');
            elements.toggleIcon.textContent = '‚ò∞'; // Ikon v√°lt√°s Men√ºre
        }
    }
    
    // Esem√©nykezel≈ë a mobil gombhoz
    elements.mobileMenuToggle.addEventListener('click', () => {
        toggleMobileMenu();
    });
    
    // HI√ÅNYZ√ì LAPOK LIST√ÅJ√ÅNAK GENER√ÅL√ÅSA
    function renderMissingCards() {
        const listContainer = elements.missingCardsList;
        listContainer.innerHTML = '';
        
        let htmlContent = '';
        
        const clubCategories = ["Botafogo", "Frankfurt", "Liverpool", "Olympiacos", "Marseille", "Inter", "Paris", "Milan", "Leverkusen", "Ajax", "PSV", "Sporting", "Al Nassr", "Atletico Madrid", "Barcelona", "Real Madrid"];

        // 1. K√ºl√∂nleges k√°rty√°k
        for (const [category, numbers] of Object.entries(MISSING_CARDS_DATA)) {
            if (!clubCategories.includes(category)) {
                const count = (numbers.match(/\d+/g) || []).length;
                htmlContent += `
                    <div class="p-3 bg-[#f8f8f8] rounded-lg shadow-sm border border-gray-200">
                        <h4 class="text-lg font-semibold text-[#FF6B6B]">${category} (${count} db)</h4>
                        <p class="text-gray-700 break-words mt-1">${numbers}</p>
                    </div>
                `;
            }
        }
        
        // 2. Klubok r√©sz
        htmlContent += '<h4 class="text-xl font-bold text-[#118AB2] mt-6 mb-3 border-t pt-4 border-gray-300">Klubok (Csapatok)</h4>';
        
        for (const club of clubCategories) {
            if (MISSING_CARDS_DATA[club]) {
                const numbers = MISSING_CARDS_DATA[club];
                const count = (numbers.match(/\d+/g) || []).length;
                htmlContent += `
                    <div class="p-3 bg-[#f8f8f8] rounded-lg shadow-sm border border-gray-200">
                        <h4 class="text-lg font-semibold text-[#06D6A0]">${club} (${count} db)</h4>
                        <p class="text-gray-700 break-words mt-1">${numbers}</p>
                    </div>
                `;
            }
        }
        
        listContainer.innerHTML = htmlContent;
    }


    // F√úGGV√âNY: Kezeli a sz≈±r√©st
    function filterCards(filterValue) {
        
        // Bez√°rja a klubmen√ºt, ha nem a klubgombon kattintottak
        const dropdownMenuEl = document.getElementById('club-dropdown-menu');
        if (dropdownMenuEl) {
             // Nem z√°rja be automatikusan, mivel az alap√©rtelmezett √°llapot a nyitott
        }
        
        // **MOBIL JAV√çT√ÅS:** Z√°rjuk be a men√ºt minden kateg√≥riav√°laszt√°sn√°l
        if (window.innerWidth < 768) {
            toggleMobileMenu(false); 
        }

        // N√©zet v√°lt√°sa
        elements.welcomeScreen.classList.add('hidden');
        elements.filteredCardView.classList.add('hidden');
        elements.paginationControls.classList.add('hidden');
        elements.missingCardsView.classList.add('hidden'); // Alap√©rtelmezetten rejtj√ºk

        if (filterValue === 'Kezd≈ëoldal') {
            currentCategory = 'Kezd≈ëoldal';
            filteredCards = [];
            
            // K√∂zvetlen visszaugr√°s a kezd≈ëlapra
            elements.welcomeScreen.classList.remove('hidden');
            
            updateFilterButtons(filterValue);
            startConfetti();
            return;
        }

        if (filterValue === 'Hi√°nyz√≥ K√°rty√°k') {
             currentCategory = 'Hi√°nyz√≥ K√°rty√°k';
             renderMissingCards();
             elements.missingCardsView.classList.remove('hidden'); // Megjelen√≠tj√ºk a hi√°nyz√≥ lapok n√©zetet
             stopConfetti();
             updateFilterButtons(filterValue);
             return;
        }
        
        if (filterValue === '√ñsszes k√°rtya') {
            filteredCards = swapCardsData;
        } else {
            // Sz≈±r√©s kateg√≥ri√°ra VAGY csapatn√©vre
            filteredCards = swapCardsData.filter(card => 
                card.category === filterValue || card.team === filterValue
            );
        }
        
        currentCardIndex = 0;
        currentCategory = filterValue;
        
        elements.filteredCardView.classList.remove('hidden');
        elements.paginationControls.classList.remove('hidden');
        
        stopConfetti();
        updateCardDisplay();
        updateFilterButtons(filterValue);
    }

    // HELPER: L√©trehoz egy gombot
    function createButton(text, filterValue, additionalClasses = '') {
        const button = document.createElement('button');
        // JAV√çTVA: text-left hozz√°adva a gombokhoz az asztali igaz√≠t√°shoz
        button.className = `filter-button text-sm font-semibold py-1.5 px-3 rounded-lg transition-colors duration-200 whitespace-nowrap w-full text-left ${additionalClasses}`;
        button.dataset.category = filterValue;
        button.textContent = text;
        button.addEventListener('click', () => filterCards(filterValue));
        return button;
    }

    // F√úGGV√âNY: Friss√≠ti a gombok st√≠lus√°t az akt√≠v kateg√≥ria alapj√°n
    function updateFilterButtons(activeCategory) {
        const categoryToActivate = activeCategory === null ? 'Kezd≈ëoldal' : activeCategory; 
        const isClubSelected = structuredCategories.clubs.includes(categoryToActivate);
        
        // Gombok friss√≠t√©se
        document.querySelectorAll('.filter-button').forEach(button => {
            // Alap st√≠lus
            button.classList.remove('bg-[#118AB2]', 'text-white', 'shadow-md', 'bg-[#FF6B6B]'); // Piros elt√°vol√≠tva
            
            if (button.dataset.category === 'Hi√°nyz√≥ K√°rty√°k') {
                 button.classList.add('bg-[#FF6B6B]', 'text-white', 'hover:bg-[#FF6B6B]80');
                 if (button.dataset.category === categoryToActivate) {
                     button.classList.add('shadow-md', 'ring-2', 'ring-[#FFD166]'); // Akt√≠v piros kiemel√©s
                 } else {
                     button.classList.remove('shadow-md', 'ring-2', 'ring-[#FFD166]');
                 }
            } else if (button.closest('ul')) {
                // Klub almen√º st√≠lusa
                button.classList.add('text-gray-700', 'hover:bg-[#FFD166]');
            } else {
                // Norm√°l kateg√≥ria st√≠lusa
                button.classList.add('bg-gray-200', 'text-gray-700', 'hover:bg-gray-300');
            }

            // Akt√≠v st√≠lus fel√ºl√≠r√°sa (norm√°l/kezd≈ëoldal/klub kateg√≥ri√°khoz)
            if (button.dataset.category === categoryToActivate && button.dataset.category !== 'Hi√°nyz√≥ K√°rty√°k') {
                button.classList.remove('bg-gray-200', 'text-gray-700', 'hover:bg-gray-300', 'hover:bg-[#FFD166]');
                button.classList.add('bg-[#118AB2]', 'text-white', 'shadow-md');
            }
        });
        
        // KLUBOK f≈ë gombj√°nak vizu√°lis friss√≠t√©se, ha egy klub ki van v√°lasztva
        const clubButton = document.getElementById('club-main-button');
        if (clubButton) {
            if (isClubSelected) {
                 clubButton.classList.add('bg-[#FF6B6B]', 'text-white', 'shadow-md');
                 clubButton.classList.remove('bg-gray-200', 'text-gray-700');
            } else {
                 clubButton.classList.remove('bg-[#FF6B6B]', 'text-white', 'shadow-md');
                 clubButton.classList.add('bg-gray-200', 'text-gray-700');
            }
        }
    }


    // F√úGGV√âNY: L√©trehozza a men√º strukt√∫r√°t (speci√°lis Klubok r√©sszel)
    function renderFilterButtons() {
        const structured = getStructuredCategories();
        const filterContainer = elements.filterContainer;
        filterContainer.innerHTML = '';

        // 1. Norm√°l Kateg√≥ri√°k (Kezd≈ëoldal, Hi√°nyz√≥ K√°rty√°k, Elite, WC)
        structured.regular.filter(cat => cat !== '√ñsszes k√°rtya').forEach(category => {
            if (!category) return;
            // K√ºl√∂nleges st√≠lus a Hi√°nyz√≥ K√°rty√°k men√ºponthoz
            const extraClass = category === 'Hi√°nyz√≥ K√°rty√°k' ? 'bg-[#FF6B6B] text-white hover:bg-[#FF6B6B]80' : '';
            const button = createButton(category, category, extraClass);
            filterContainer.appendChild(button);
        });

        // 2. Klubok leny√≠l√≥ men√º (CLICK logik√°val)
        const clubWrapper = document.createElement('div');
        clubWrapper.id = 'club-wrapper'; 
        
        const clubButton = document.createElement('button');
        clubButton.id = 'club-main-button'; 
        clubButton.className = 'w-full text-left font-bold text-sm py-1.5 px-3 rounded-lg transition-colors duration-200 bg-gray-200 text-gray-700 hover:bg-gray-300';
        clubButton.textContent = 'Klubok ‚ñ≤';
        
        const dropdownMenu = document.createElement('ul');
        dropdownMenu.id = 'club-dropdown-menu';
        dropdownMenu.className = 'w-full bg-white rounded-lg shadow-inner py-1 z-20 border-t border-gray-100 max-h-[250px] overflow-y-auto';

        clubButton.addEventListener('click', (e) => {
            e.preventDefault();
            const isHidden = dropdownMenu.classList.contains('hidden');

            if (isHidden) {
                dropdownMenu.classList.remove('hidden');
                clubButton.textContent = 'Klubok ‚ñ≤';
            } else {
                dropdownMenu.classList.add('hidden');
                clubButton.textContent = 'Klubok üîª';
            }
        });
        
        clubWrapper.appendChild(clubButton);

        structured.clubs.forEach(clubName => {
            const listItem = document.createElement('li');
            const clubFilterButton = createButton(clubName, clubName, 'text-left w-full rounded-none');
            clubFilterButton.classList.remove('py-2');
            clubFilterButton.classList.add('py-1.5');
            
            listItem.appendChild(clubFilterButton);
            dropdownMenu.appendChild(listItem);
        });

        clubWrapper.appendChild(dropdownMenu);
        filterContainer.appendChild(clubWrapper);
        
        // Kezdeti √°llapot be√°ll√≠t√°sa
        updateFilterButtons(null);
        startConfetti();
    }

    function updateCardDisplay() {
        if (filteredCards.length === 0) {
            elements.cardImage.src = 'https://placehold.co/300x400/FF6B6B/ffffff?text=Nincs+k%C3%A1rtya';
            elements.cardName.textContent = 'Nincs el√©rhet≈ë k√°rtya ebben a kateg√≥ri√°ban.';
            elements.cardNumber.textContent = 'N/A';
            elements.cardTeam.textContent = 'N/A';
            elements.currentCategoryEl.textContent = currentCategory;
            elements.cardCounter.textContent = '0 / 0';
            elements.prevButton.disabled = true;
            elements.nextButton.disabled = true;
            return;
        }

        const card = filteredCards[currentCardIndex];
        
        elements.cardImage.style.opacity = '0'; 
        setTimeout(() => {
            elements.cardImage.classList.remove('object-cover'); 
            elements.cardImage.src = card.img;
            elements.cardImage.style.opacity = '1';
        }, 150); 
        
        elements.cardName.textContent = card.name;
        elements.cardNumber.textContent = card.number;
        elements.cardTeam.textContent = card.team;
        elements.currentCategoryEl.textContent = currentCategory;
        elements.cardCounter.textContent = `${currentCardIndex + 1} / ${filteredCards.length}`;

        elements.prevButton.disabled = currentCardIndex === 0;
        elements.nextButton.disabled = currentCardIndex === filteredCards.length - 1;
    }

    function handlePrev() {
        if (currentCardIndex > 0) {
            currentCardIndex--;
            updateCardDisplay();
        }
    }

    function handleNext() {
        if (currentCardIndex < filteredCards.length - 1) {
            currentCardIndex++;
            updateCardDisplay();
        }
    }

    elements.prevButton.addEventListener('click', handlePrev);
    elements.nextButton.addEventListener('click', handleNext);

    document.addEventListener('DOMContentLoaded', renderFilterButtons);

</script>
</body>
</html>

